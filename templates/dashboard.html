<!doctype html>
<html lang="en">
<head>
    <title>CyberOps Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <script src="{{ url_for('static', filename='tabs.js') }}"></script>
</head>
<body>
    <div class="banner">{{ banner }}</div>
    <div class="userbar">
        User: <b>{{ username }}</b> | <a href="{{ url_for('logout') }}">Logout</a> | v{{ version }}
    </div>
    <div class="tabs">
        <button class="tablink" onclick="openTab(event, 'Recon')" id="defaultTab">White Hat / Recon</button>
        <button class="tablink" onclick="openTab(event, 'Red')">Red Team</button>
        <button class="tablink" onclick="openTab(event, 'Blue')">Blue Team</button>
        <button class="tablink" onclick="openTab(event, 'Purple')">Purple / Gray</button>
        <button class="tablink" onclick="openTab(event, 'Black')">Black Hat / C2</button>
        <button class="tablink" onclick="openTab(event, 'Reporting')">Reporting</button>
    </div>
    <div id="Recon" class="tabcontent">
        <h2>White Hat / Reconnaissance</h2>
        <ul>
            <li><a href="{{ url_for('tool', tool='nmap') }}">Nmap</a></li>
            <li><a href="{{ url_for('tool', tool='whois') }}">Whois</a></li>
            <li><a href="{{ url_for('tool', tool='dnsrecon') }}">dnsrecon</a></li>
            <li><a href="{{ url_for('tool', tool='dig') }}">dig</a></li>
            <li><a href="{{ url_for('tool', tool='sublist3r') }}">Sublist3r</a></li>
            <li><a href="{{ url_for('tool', tool='amass') }}">Amass</a></li>
            <li><a href="{{ url_for('tool', tool='theharvester') }}">theHarvester</a></li>
        </ul>
    </div>
    <div id="Red" class="tabcontent">
        <h2>Red Team / Offensive</h2>
        <ul>
            <li><a href="{{ url_for('tool', tool='nikto') }}">Nikto</a></li>
            <li><a href="{{ url_for('tool', tool='dirsearch') }}">dirsearch</a></li>
            <li><a href="{{ url_for('tool', tool='gobuster') }}">Gobuster</a></li>
            <li><a href="{{ url_for('tool', tool='sqlmap') }}">sqlmap</a></li>
            <li><a href="{{ url_for('tool', tool='xsser') }}">xsser</a></li>
            <li><a href="{{ url_for('tool', tool='httpreq') }}">Custom HTTP</a></li>
            <li><a href="{{ url_for('tool', tool='hydra') }}">Hydra</a></li>
            <li><a href="{{ url_for('tool', tool='hashcat') }}">Hashcat</a></li>
            <li><a href="{{ url_for('tool', tool='john') }}">John the Ripper</a></li>
            <li><a href="{{ url_for('tool', tool='hashid') }}">HashID</a></li>
            <li><a href="{{ url_for('tool', tool='namethathash') }}">Name-That-Hash</a></li>
            <li><a href="{{ url_for('tool', tool='wordlistmgr') }}">Wordlist Manager</a></li>
            <li><a href="{{ url_for('tool', tool='msfvenom') }}">msfvenom</a></li>
            <li><a href="{{ url_for('tool', tool='revshell') }}">Reverse Shell</a></li>
            <li><a href="{{ url_for('tool', tool='encoder') }}">Payload Encoder</a></li>
            <li><a href="{{ url_for('tool', tool='sessionlog') }}">Session Log Viewer</a></li>
        </ul>
    </div>
    <div id="Blue" class="tabcontent">
        <h2>Blue Team / Defense</h2>
        <ul>
            <li><a href="{{ url_for('tool', tool='loganalyzer') }}">Log Analyzer</a></li>
            <li><a href="{{ url_for('tool', tool='iocscanner') }}">IOC Scanner</a></li>
            <li><a href="{{ url_for('tool', tool='sigma') }}">Sigma Rule Tester</a></li>
            <li><a href="{{ url_for('tool', tool='assetinv') }}">Asset Inventory</a></li>
            <li><a href="{{ url_for('tool', tool='pcapview') }}">Network PCAP Viewer</a></li>
        </ul>
    </div>
    <div id="Purple" class="tabcontent">
        <h2>Purple / Gray Team</h2>
        <ul>
            <li><a href="{{ url_for('tool', tool='exercise') }}">Exercise Planner</a></li>
            <li><a href="{{ url_for('tool', tool='detectiongap') }}">Detection Gap Analyzer</a></li>
            <li><a href="{{ url_for('tool', tool='timeline') }}">Timeline Visualizer</a></li>
            <li><a href="{{ url_for('tool', tool='notes') }}">Shared Notes</a></li>
        </ul>
    </div>
    <div id="Black" class="tabcontent">
        <h2>Black Hat / C2 & Dual-use Tools</h2>
        <ul>
            <li><a href="{{ url_for('tool', tool='empire') }}">Empire C2</a></li>
            <li><a href="{{ url_for('tool', tool='sliver') }}">Sliver C2</a></li>
            <li><a href="{{ url_for('tool', tool='mythic') }}">Mythic C2</a></li>
            <!-- Add more if you have them installed and authorized -->
        </ul>
        <p style="color:#ff4444;"><b>WARNING:</b> For isolated, authorized internal lab use only. All actions are logged. Use of C2 tools outside of the lab is illegal and unethical.</p>
    </div>
    <div id="Reporting" class="tabcontent">
        <h2>Reporting & Compliance</h2>
        <a href="{{ url_for('report') }}">View Audit Trail & Reports</a>
    </div>
    <script>
        document.getElementById("defaultTab").click();
    </script>
</body>
</html>